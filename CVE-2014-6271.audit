# Description: Quick and dirty check for CVE-2014-6271
# Author: Ignacio Lis - lis@coit.es
<check_type:"Unix">
<if>
<condition type	: "AND">
<custom_item>
 system			: "Linux"
 type			: CMD_EXEC
 description	: "Bash is installed"
 cmd			: "which bash"
 regex			: "/bin/bash"
 expect			: "/bin/bash"
</custom_item>
</condition>
<then>
<custom_item>
 system			: "Linux"
 type			: CMD_EXEC
 description	: "Bash upgraded to patch CVE-2014-6271"
 info			: "Bash Code Injection Vulnerability via Specially Crafted Environment Variables,"
 info			: "if this compliance check fails update bash ASAP."
 reference		: "CVE-2014-6271"
 see_also		: "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6271"
 solution		: "Upgrade bash ASAP."
 cmd			: "/usr/bin/env x='() { :;}; echo vulnerable'  bash -c \"echo this is a test\" | grep \"vulnerable\" 2>/dev/null | wc -l"
 expect			: "0"
 dont_echo_cmd	: YES
</custom_item>
</then>
<else>
<report type	: "WARNING" >
 description	:"Bash not found"
 info			:"Bash not found"
</report>
</else>
</if>
</check_type>
